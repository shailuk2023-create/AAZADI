<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Addiction Challenge Tracker</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary: #6a11cb;
            --secondary: #2575fc;
            --accent: #ff4d94;
            --success: #00c851;
            --warning: #ffbb33;
            --danger: #ff3547;
            --dark: #121212;
            --light: #f8f9fa;
            --gray: #6c757d;
            --transition: all 0.3s ease;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background: linear-gradient(135deg, var(--dark), #1a1a2e);
            color: var(--light);
            min-height: 100vh;
            overflow-x: hidden;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        /* Setup Screen */
        .setup-screen {
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            text-align: center;
            padding: 20px;
            background: radial-gradient(circle at center, rgba(106, 17, 203, 0.1), transparent 70%);
            animation: fadeIn 1.5s ease;
        }

        .app-logo {
            width: 120px;
            height: 120px;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            margin-bottom: 30px;
            box-shadow: 0 10px 30px rgba(106, 17, 203, 0.5);
            animation: pulse 2s infinite;
        }

        .app-logo i {
            font-size: 50px;
            color: white;
        }

        .setup-title {
            font-size: 3rem;
            font-weight: 800;
            background: linear-gradient(to right, var(--primary), var(--secondary));
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            margin-bottom: 15px;
            line-height: 1.2;
        }

        .setup-subtitle {
            font-size: 1.2rem;
            margin-bottom: 40px;
            color: #ccc;
            max-width: 600px;
        }

        .setup-form {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 30px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            max-width: 500px;
            width: 100%;
        }

        .form-group {
            margin-bottom: 20px;
            text-align: left;
        }

        .form-label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #ddd;
        }

        .form-input {
            width: 100%;
            padding: 12px 15px;
            border-radius: 10px;
            border: 1px solid rgba(255, 255, 255, 0.3);
            background: rgba(255, 255, 255, 0.1);
            color: white;
            font-size: 1rem;
            transition: var(--transition);
        }

        .form-input:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 2px rgba(106, 17, 203, 0.3);
        }

        .form-select {
            width: 100%;
            padding: 12px 15px;
            border-radius: 10px;
            border: 1px solid rgba(255, 255, 255, 0.3);
            background: rgba(255, 255, 255, 0.1);
            color: white;
            font-size: 1rem;
            transition: var(--transition);
        }

        .form-select option {
            background: #2a2a2a;
            color: white;
        }

        .btn {
            padding: 15px 40px;
            border-radius: 50px;
            font-size: 1.2rem;
            font-weight: 600;
            border: none;
            cursor: pointer;
            transition: var(--transition);
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            text-decoration: none;
        }

        .btn-primary {
            background: linear-gradient(to right, var(--primary), var(--secondary));
            color: white;
            box-shadow: 0 5px 15px rgba(106, 17, 203, 0.4);
        }

        .btn-primary:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(106, 17, 203, 0.6);
        }

        .btn-secondary {
            background: rgba(255, 255, 255, 0.1);
            color: white;
            border: 1px solid rgba(255, 255, 255, 0.3);
        }

        .btn-secondary:hover {
            background: rgba(255, 255, 255, 0.2);
        }

        .btn-success {
            background: var(--success);
            color: white;
        }

        .btn-warning {
            background: var(--warning);
            color: #333;
        }

        .btn-danger {
            background: var(--danger);
            color: white;
        }

        .btn-disabled {
            background: #6c757d;
            color: #ccc;
            cursor: not-allowed;
        }

        .btn-disabled:hover {
            transform: none;
            box-shadow: none;
        }

        /* Welcome Screen */
        .welcome-screen {
            display: none;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            text-align: center;
            padding: 20px;
            background: radial-gradient(circle at center, rgba(106, 17, 203, 0.1), transparent 70%);
            animation: fadeIn 1.5s ease;
        }

        .welcome-title {
            font-size: 3rem;
            font-weight: 800;
            background: linear-gradient(to right, var(--primary), var(--secondary));
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            margin-bottom: 15px;
            line-height: 1.2;
        }

        .welcome-subtitle {
            font-size: 1.5rem;
            margin-bottom: 40px;
            color: #ccc;
            max-width: 600px;
        }

        .progress-info {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 15px 30px;
            margin-bottom: 40px;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        /* Main App Screen */
        .app-screen {
            display: none;
            min-height: 100vh;
            padding: 20px;
        }

        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px 0;
            margin-bottom: 30px;
        }

        .app-title {
            font-size: 2rem;
            font-weight: 700;
            background: linear-gradient(to right, var(--primary), var(--secondary));
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
        }

        .user-profile {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .avatar {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: linear-gradient(to right, var(--primary), var(--secondary));
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
        }

        .level-badge {
            background: linear-gradient(to right, var(--warning), var(--accent));
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 0.9rem;
            font-weight: 600;
        }

        /* Dashboard */
        .dashboard {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 40px;
        }

        .card {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 25px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            transition: var(--transition);
        }

        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.2);
        }

        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .card-title {
            font-size: 1.3rem;
            font-weight: 600;
        }

        .card-icon {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.2);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
        }

        .progress-bar {
            height: 10px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 5px;
            overflow: hidden;
            margin: 15px 0;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(to right, var(--primary), var(--secondary));
            border-radius: 5px;
            transition: width 1s ease;
        }

        /* Daily Challenge */
        .daily-challenge {
            margin-bottom: 40px;
        }

        .challenge-card {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 30px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .challenge-header {
            margin-bottom: 20px;
        }

        .day-badge {
            background: linear-gradient(to right, var(--primary), var(--secondary));
            padding: 8px 20px;
            border-radius: 20px;
            font-size: 1rem;
            font-weight: 600;
            display: inline-block;
            margin-bottom: 15px;
        }

        .challenge-title {
            font-size: 1.8rem;
            font-weight: 700;
            margin-bottom: 10px;
        }

        .challenge-description {
            font-size: 1.2rem;
            line-height: 1.6;
            margin-bottom: 30px;
            color: #ddd;
        }

        .motivational-quote {
            font-style: italic;
            font-size: 1.1rem;
            margin: 30px 0;
            padding: 20px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 10px;
            border-left: 4px solid var(--accent);
        }

        /* Monthly Calendar View */
        .calendar-view {
            margin-top: 40px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 15px;
            padding: 20px;
            backdrop-filter: blur(10px);
        }

        .calendar-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .calendar-title {
            font-size: 1.5rem;
            font-weight: 600;
        }

        .calendar-nav {
            display: flex;
            gap: 10px;
        }

        .calendar-weekdays {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 5px;
            margin-bottom: 10px;
        }

        .weekday {
            text-align: center;
            font-weight: 600;
            padding: 10px;
            color: #aaa;
        }

        .calendar-grid {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 5px;
        }

        .calendar-day {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            padding: 10px 5px;
            text-align: center;
            transition: var(--transition);
            border: 2px solid transparent;
            position: relative;
            min-height: 60px;
            display: flex;
            flex-direction: column;
            justify-content: flex-start;
            align-items: center;
        }

        .calendar-day:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }

        .calendar-day.completed {
            background: rgba(0, 200, 81, 0.2);
            border-color: var(--success);
        }

        .calendar-day.completed::after {
            content: '✓';
            position: absolute;
            top: 3px;
            right: 3px;
            background: var(--success);
            color: white;
            width: 18px;
            height: 18px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 10px;
            font-weight: bold;
        }

        .calendar-day.missed {
            background: rgba(255, 53, 71, 0.2);
            border-color: var(--danger);
        }

        .calendar-day.missed::after {
            content: '✗';
            position: absolute;
            top: 3px;
            right: 3px;
            background: var(--danger);
            color: white;
            width: 18px;
            height: 18px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 10px;
            font-weight: bold;
        }

        .calendar-day.current {
            background: rgba(106, 17, 203, 0.3);
            border-color: var(--primary);
            animation: pulse 2s infinite;
        }

        .calendar-day.future {
            background: rgba(108, 117, 125, 0.2);
            color: #6c757d;
        }

        .calendar-day.future .day-number {
            color: #6c757d;
        }

        .calendar-day.other-month {
            background: rgba(108, 117, 125, 0.1);
            color: #6c757d;
        }

        .calendar-day.other-month .day-number {
            color: #6c757d;
        }

        .day-number {
            font-size: 1rem;
            font-weight: 700;
            margin-bottom: 2px;
        }

        .day-status {
            font-size: 0.6rem;
            font-weight: 600;
        }

        /* Reset Challenge Modal */
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            animation: fadeIn 0.5s ease;
        }

        .modal-content {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            padding: 40px;
            border-radius: 20px;
            text-align: center;
            max-width: 600px;
            width: 90%;
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.5);
            animation: scaleUp 0.5s ease;
        }

        .modal-title {
            font-size: 2rem;
            font-weight: 800;
            margin-bottom: 20px;
            color: white;
        }

        .modal-message {
            font-size: 1.2rem;
            margin-bottom: 30px;
            color: rgba(255, 255, 255, 0.9);
            line-height: 1.6;
        }

        .promise-text {
            background: rgba(255, 255, 255, 0.1);
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
            font-style: italic;
            border-left: 4px solid var(--accent);
        }

        .promise-input {
            width: 100%;
            padding: 15px;
            border-radius: 10px;
            border: 1px solid rgba(255, 255, 255, 0.3);
            background: rgba(255, 255, 255, 0.1);
            color: white;
            font-size: 1rem;
            margin: 15px 0;
            resize: vertical;
            min-height: 100px;
        }

        .promise-input:focus {
            outline: none;
            border-color: var(--accent);
            box-shadow: 0 0 0 2px rgba(255, 77, 148, 0.3);
        }

        /* Celebration Animation */
        .celebration {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.9);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            animation: fadeIn 0.5s ease;
        }

        .celebration-content {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            padding: 40px;
            border-radius: 20px;
            text-align: center;
            max-width: 600px;
            width: 90%;
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.5);
            animation: scaleUp 0.5s ease;
        }

        .celebration-title {
            font-size: 3rem;
            font-weight: 800;
            margin-bottom: 20px;
            color: white;
        }

        .celebration-message {
            font-size: 1.5rem;
            margin-bottom: 30px;
            color: rgba(255, 255, 255, 0.9);
        }

        .achievement-badge {
            width: 150px;
            height: 150px;
            background: linear-gradient(135deg, gold, orange);
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            margin: 0 auto 30px;
            box-shadow: 0 10px 30px rgba(255, 215, 0, 0.5);
            animation: pulse 2s infinite;
        }

        .achievement-badge i {
            font-size: 70px;
            color: white;
        }

        .confetti {
            position: absolute;
            width: 10px;
            height: 10px;
            background: var(--accent);
            border-radius: 50%;
            animation: confettiFall 5s linear forwards;
        }

        /* Stats Screen */
        .stats-screen {
            display: none;
            min-height: 100vh;
            padding: 20px;
        }

        .stats-header {
            text-align: center;
            margin-bottom: 40px;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 40px;
        }

        .stat-card {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 25px;
            text-align: center;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .stat-value {
            font-size: 3rem;
            font-weight: 800;
            margin: 15px 0;
            background: linear-gradient(to right, var(--primary), var(--secondary));
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
        }

        .stat-label {
            font-size: 1.1rem;
            color: #ccc;
        }

        /* Continue Challenge Modal */
        .continue-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            animation: fadeIn 0.5s ease;
        }

        .continue-content {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            padding: 40px;
            border-radius: 20px;
            text-align: center;
            max-width: 600px;
            width: 90%;
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.5);
            animation: scaleUp 0.5s ease;
        }

        .continue-title {
            font-size: 2rem;
            font-weight: 800;
            margin-bottom: 20px;
            color: white;
        }

        .continue-message {
            font-size: 1.2rem;
            margin-bottom: 30px;
            color: rgba(255, 255, 255, 0.9);
        }

        /* Animations */
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }

        @keyframes scaleUp {
            from { transform: scale(0.8); opacity: 0; }
            to { transform: scale(1); opacity: 1; }
        }

        @keyframes confettiFall {
            0% { transform: translateY(-100px) rotate(0deg); opacity: 1; }
            100% { transform: translateY(100vh) rotate(360deg); opacity: 0; }
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .setup-title, .welcome-title {
                font-size: 2.5rem;
            }
            
            .setup-subtitle, .welcome-subtitle {
                font-size: 1.2rem;
            }
            
            .dashboard {
                grid-template-columns: 1fr;
            }
            
            .btn {
                padding: 12px 25px;
                font-size: 1rem;
            }
            
            .calendar-day {
                min-height: 50px;
                padding: 5px 2px;
            }
            
            .day-number {
                font-size: 0.9rem;
            }
        }

        @media (max-width: 480px) {
            .calendar-day {
                min-height: 40px;
            }
            
            .day-number {
                font-size: 0.8rem;
            }
            
            .weekday {
                padding: 5px;
                font-size: 0.8rem;
            }
        }
    </style>
</head>
<body>
    <!-- Setup Screen -->
    <section class="setup-screen" id="setupScreen">
        <div class="app-logo">
            <i class="fas fa-trophy"></i>
        </div>
        <h1 class="setup-title">Addiction Challenge Tracker</h1>
        <p class="setup-subtitle">Transform Your Life • Build Better Habits • Win Your Freedom</p>
        
        <div class="setup-form">
            <div class="form-group">
                <label for="userName" class="form-label">Your Name</label>
                <input type="text" id="userName" class="form-input" placeholder="Enter your name">
            </div>
            
            <div class="form-group">
                <label for="addictionType" class="form-label">Which addiction do you want to overcome?</label>
                <select id="addictionType" class="form-select">
                    <option value="general">General Addiction/Habit</option>
                    <option value="smoking">Smoking</option>
                    <option value="alcohol">Alcohol</option>
                    <option value="social_media">Social Media Addiction</option>
                    <option value="gaming">Gaming Addiction</option>
                    <option value="junk_food">Junk Food</option>
                    <option value="procrastination">Procrastination</option>
                    <option value="other">Other</option>
                </select>
            </div>
            
            <div class="form-group">
                <label for="challengeDuration" class="form-label">Challenge Duration</label>
                <select id="challengeDuration" class="form-select">
                    <option value="21">21 Days (Habit Formation)</option>
                    <option value="45">45 Days (Intermediate)</option>
                    <option value="90" selected>90 Days (Full Transformation)</option>
                    <option value="180">180 Days (Deep Change)</option>
                    <option value="365">365 Days (Lifestyle Change)</option>
                </select>
            </div>
        </div>
        
        <button class="btn btn-primary" id="saveSetup">
            <i class="fas fa-play-circle"></i> Start Challenge
        </button>
    </section>

    <!-- Welcome Screen -->
    <section class="welcome-screen" id="welcomeScreen">
        <div class="app-logo">
            <i class="fas fa-trophy"></i>
        </div>
        <h1 class="welcome-title" id="personalizedTitle">Addiction Challenge</h1>
        <p class="welcome-subtitle">Transform Your Life • Build Better Habits • Win Your Freedom</p>
        
        <div class="progress-info">
            <p>Current Level: <span id="currentLevel">1</span> | Day: <span id="currentDay">1</span>/<span id="totalDays">90</span></p>
            <p id="todayDate">Today's Date: Loading...</p>
            <p id="nextAvailableDate">Next Challenge Available: Loading...</p>
        </div>
        
        <button class="btn btn-primary" id="startChallenge">
            <i class="fas fa-rocket"></i> Start Today's Challenge
        </button>
        
        <button class="btn btn-secondary" id="viewStats" style="margin-top: 15px;">
            <i class="fas fa-chart-line"></i> View Progress Stats
        </button>

        <button class="btn btn-secondary" id="viewCalendar" style="margin-top: 15px;">
            <i class="fas fa-calendar-alt"></i> View Calendar
        </button>
        
        <button class="btn btn-warning" id="resetChallenge" style="margin-top: 15px;">
            <i class="fas fa-redo"></i> Reset Challenge (Broken Promise)
        </button>
    </section>

    <!-- Main App Screen -->
    <section class="app-screen" id="appScreen">
        <div class="container">
            <div class="header">
                <h1 class="app-title" id="appTitle">Addiction Challenge</h1>
                <div class="user-profile">
                    <div class="level-badge">Level <span id="displayLevel">1</span></div>
                    <div class="avatar" id="userAvatar">U</div>
                </div>
            </div>
            
            <div class="dashboard">
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">Progress</h3>
                        <div class="card-icon">
                            <i class="fas fa-chart-bar"></i>
                        </div>
                    </div>
                    <p>Day <span id="progressDay">1</span> of <span id="totalDaysProgress">90</span></p>
                    <div class="progress-bar">
                        <div class="progress-fill" id="progressFill" style="width: 1%;"></div>
                    </div>
                    <p><span id="progressPercent">1</span>% Complete</p>
                </div>
                
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">Streak</h3>
                        <div class="card-icon">
                            <i class="fas fa-fire"></i>
                        </div>
                    </div>
                    <p id="streakCount">0 Days</p>
                    <p>Keep going! Don't break the chain.</p>
                </div>
                
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">Motivation</h3>
                        <div class="card-icon">
                            <i class="fas fa-quote-right"></i>
                        </div>
                    </div>
                    <p id="dailyMotivation">Your journey to freedom starts today!</p>
                    <button class="btn btn-secondary" id="newQuote" style="margin-top: 15px; padding: 8px 15px;">
                        <i class="fas fa-sync-alt"></i> New Quote
                    </button>
                </div>
            </div>
            
            <div class="daily-challenge">
                <div class="challenge-card">
                    <div class="challenge-header">
                        <div class="day-badge">Day <span id="challengeDay">1</span></div>
                        <h2 class="challenge-title" id="challengeTitle">Identify Your Triggers</h2>
                        <p id="challengeDateDisplay">Date: Loading...</p>
                    </div>
                    <p class="challenge-description" id="challengeDescription">
                        Today, take some time to identify the situations, emotions, or people that trigger your addictive behavior. Write them down and create a plan to avoid or manage these triggers.
                    </p>
                    
                    <div class="motivational-quote" id="motivationalQuote">
                        "The first step towards getting somewhere is to decide that you are not going to stay where you are." - J.P. Morgan
                    </div>
                    
                    <button class="btn btn-primary" id="completeChallenge">
                        <i class="fas fa-check-circle"></i> Complete Today's Challenge
                    </button>

                    <button class="btn btn-secondary" id="markMissedDay" style="margin-top: 15px;">
                        <i class="fas fa-calendar-times"></i> Mark This Day as Missed
                    </button>
                </div>
            </div>

            <!-- Monthly Calendar View -->
            <div class="calendar-view" id="calendarView">
                <div class="calendar-header">
                    <h3 class="calendar-title" id="calendarMonthTitle">January 2023</h3>
                    <div class="calendar-nav">
                        <button class="btn btn-secondary" id="prevMonth" style="padding: 8px 15px;">
                            <i class="fas fa-chevron-left"></i>
                        </button>
                        <button class="btn btn-secondary" id="nextMonth" style="padding: 8px 15px;">
                            <i class="fas fa-chevron-right"></i>
                        </button>
                    </div>
                </div>
                
                <div class="calendar-weekdays">
                    <div class="weekday">Sun</div>
                    <div class="weekday">Mon</div>
                    <div class="weekday">Tue</div>
                    <div class="weekday">Wed</div>
                    <div class="weekday">Thu</div>
                    <div class="weekday">Fri</div>
                    <div class="weekday">Sat</div>
                </div>
                
                <div class="calendar-grid" id="calendarGrid">
                    <!-- Calendar days will be generated here -->
                </div>
            </div>
            
            <div style="text-align: center; margin-top: 30px;">
                <button class="btn btn-secondary" id="backToWelcome">
                    <i class="fas fa-home"></i> Back to Home
                </button>
            </div>
        </div>
    </section>

    <!-- Stats Screen -->
    <section class="stats-screen" id="statsScreen">
        <div class="container">
            <div class="stats-header">
                <h1 class="app-title">Your Progress Stats</h1>
                <p>Track your journey to freedom</p>
            </div>
            
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="card-icon">
                        <i class="fas fa-calendar-check"></i>
                    </div>
                    <div class="stat-value" id="statDaysCompleted">0</div>
                    <div class="stat-label">Days Completed</div>
                </div>
                
                <div class="stat-card">
                    <div class="card-icon">
                        <i class="fas fa-fire"></i>
                    </div>
                    <div class="stat-value" id="statStreak">0</div>
                    <div class="stat-label">Current Streak</div>
                </div>
                
                <div class="stat-card">
                    <div class="card-icon">
                        <i class="fas fa-trophy"></i>
                    </div>
                    <div class="stat-value" id="statLevel">1</div>
                    <div class="stat-label">Current Level</div>
                </div>
                
                <div class="stat-card">
                    <div class="card-icon">
                        <i class="fas fa-flag"></i>
                    </div>
                    <div class="stat-value" id="statDaysLeft">90</div>
                    <div class="stat-label">Days Remaining</div>
                </div>
            </div>
            
            <div class="card">
                <div class="card-header">
                    <h3 class="card-title">Progress Overview</h3>
                </div>
                <div class="progress-bar" style="height: 20px; margin: 20px 0;">
                    <div class="progress-fill" id="statProgressFill" style="width: 1%;"></div>
                </div>
                <p>You have completed <span id="statProgressPercent">1</span>% of your <span id="statTotalDays">90</span>-day journey</p>
            </div>

            <div class="card">
                <div class="card-header">
                    <h3 class="card-title">Challenge Dates</h3>
                </div>
                <p id="challengeDateRange">Loading...</p>
                <p id="todayStatus">Loading...</p>
                <p id="nextChallengeInfo">Loading...</p>
            </div>
            
            <div style="text-align: center; margin-top: 40px;">
                <button class="btn btn-primary" id="backFromStats">
                    <i class="fas fa-arrow-left"></i> Back to Challenge
                </button>
            </div>
        </div>
    </section>

    <!-- Reset Challenge Modal -->
    <div class="modal" id="resetModal">
        <div class="modal-content">
            <h2 class="modal-title">Reset Your Challenge</h2>
            <p class="modal-message">It seems you've broken your commitment. To restart your challenge, please write a promise to yourself below. This will help strengthen your resolve.</p>
            
            <div class="promise-text">
                "I promise to myself that I will complete this challenge no matter what obstacles come my way. I am stronger than my addiction and I will not give up on myself. I commit to taking one day at a time and celebrating each small victory."
            </div>
            
            <textarea class="promise-input" id="promiseInput" placeholder="Type the promise above exactly as shown to confirm your commitment..."></textarea>
            
            <button class="btn btn-primary" id="confirmReset">
                <i class="fas fa-redo"></i> Confirm Reset
            </button>
            
            <button class="btn btn-secondary" id="cancelReset" style="margin-top: 15px;">
                <i class="fas fa-times"></i> Cancel
            </button>
        </div>
    </div>

    <!-- Celebration Animation -->
    <div class="celebration" id="celebration">
        <div class="celebration-content">
            <div class="achievement-badge">
                <i class="fas fa-trophy"></i>
            </div>
            <h2 class="celebration-title">Congratulations!</h2>
            <p class="celebration-message" id="celebrationMessage">You've successfully completed your challenge! You are now free from your addiction.</p>
            
            <button class="btn btn-primary" id="continueChallenge">
                <i class="fas fa-plus-circle"></i> Continue Challenge
            </button>
            
            <button class="btn btn-secondary" id="closeCelebration" style="margin-top: 15px;">
                <i class="fas fa-home"></i> Return to Home
            </button>
        </div>
    </div>

    <!-- Continue Challenge Modal -->
    <div class="continue-modal" id="continueModal">
        <div class="continue-content">
            <h2 class="continue-title">Continue Your Journey</h2>
            <p class="continue-message">Congratulations on completing your challenge! Would you like to continue your journey with an extended challenge?</p>
            
            <div class="form-group" style="margin: 20px 0;">
                <label for="extendDuration" class="form-label">Select Extended Duration</label>
                <select id="extendDuration" class="form-select">
                    <option value="30">30 Days (Reinforcement)</option>
                    <option value="60">60 Days (Strengthening)</option>
                    <option value="90">90 Days (Mastery)</option>
                    <option value="180">180 Days (Transformation)</option>
                </select>
            </div>
            
            <button class="btn btn-primary" id="confirmExtension">
                <i class="fas fa-plus-circle"></i> Extend Challenge
            </button>
            
            <button class="btn btn-secondary" id="cancelExtension" style="margin-top: 15px;">
                <i class="fas fa-times"></i> No Thanks
            </button>
        </div>
    </div>

    <script>
        // App Data
        const appData = {
            userName: "",
            addictionType: "general",
            challengeDuration: 90,
            startDate: null,
            currentDay: 1,
            currentLevel: 1,
            streak: 0,
            lastLogin: null,
            completedDays: [],
            missedDays: [],
            challengeDates: [],
            challengeCompleted: false
        };

        // Motivational Quotes (50 quotes)
        const motivationalQuotes = [
            "Your journey to success starts with today's commitment!",
            "Every day is a new beginning, every moment a new opportunity!",
            "You become what you do every day!",
            "Success is a collection of small efforts!",
            "Today's struggle will become tomorrow's strength!",
            "Winners never quit!",
            "Your future depends on your present!",
            "Every completed day brings you closer to victory!",
            "The only way to do great work is to love what you do. - Steve Jobs",
            "It does not matter how slowly you go as long as you do not stop. - Confucius",
            "Your time is limited, don't waste it living someone else's life. - Steve Jobs",
            "The future depends on what you do today. - Mahatma Gandhi",
            "Believe you can and you're halfway there. - Theodore Roosevelt",
            "The only impossible journey is the one you never begin. - Tony Robbins",
            "Don't watch the clock; do what it does. Keep going. - Sam Levenson",
            "You are never too old to set another goal or to dream a new dream. - C.S. Lewis",
            "The way to get started is to quit talking and begin doing. - Walt Disney",
            "It always seems impossible until it's done. - Nelson Mandela",
            "You don't have to be great to start, but you have to start to be great. - Zig Ziglar",
            "The secret of getting ahead is getting started. - Mark Twain",
            "What you get by achieving your goals is not as important as what you become by achieving them. - Zig Ziglar",
            "The harder the battle, the sweeter the victory. - Les Brown",
            "Success is not final, failure is not fatal: it is the courage to continue that counts. - Winston Churchill",
            "The only limit to our realization of tomorrow will be our doubts of today. - Franklin D. Roosevelt",
            "The best time to plant a tree was 20 years ago. The second best time is now. - Chinese Proverb",
            "You miss 100% of the shots you don't take. - Wayne Gretzky",
            "I can't change the direction of the wind, but I can adjust my sails to always reach my destination. - Jimmy Dean",
            "The only person you are destined to become is the person you decide to be. - Ralph Waldo Emerson",
            "Everything you've ever wanted is on the other side of fear. - George Addair",
            "The mind is everything. What you think you become. - Buddha",
            "The best revenge is massive success. - Frank Sinatra",
            "Life is 10% what happens to you and 90% how you react to it. - Charles R. Swindoll",
            "Change your thoughts and you change your world. - Norman Vincent Peale",
            "The most difficult thing is the decision to act, the rest is merely tenacity. - Amelia Earhart",
            "You become what you believe. - Oprah Winfrey",
            "I am not a product of my circumstances. I am a product of my decisions. - Stephen Covey",
            "Every strike brings me closer to the next home run. - Babe Ruth",
            "We may encounter many defeats but we must not be defeated. - Maya Angelou",
            "The only way to achieve the impossible is to believe it is possible. - Charles Kingsleigh",
            "What lies behind us and what lies before us are tiny matters compared to what lies within us. - Ralph Waldo Emerson",
            "The question isn't who is going to let me; it's who is going to stop me. - Ayn Rand",
            "If you can dream it, you can achieve it. - Zig Ziglar",
            "The future belongs to those who believe in the beauty of their dreams. - Eleanor Roosevelt",
            "You are never too old to set another goal or to dream a new dream. - C.S. Lewis",
            "The only thing standing between you and your goal is the story you keep telling yourself. - Jordan Belfort",
            "Your limitation—it's only your imagination.",
            "Push yourself, because no one else is going to do it for you.",
            "Great things never come from comfort zones.",
            "Dream it. Wish it. Do it.",
            "Success doesn't just find you. You have to go out and get it."
        ];

        // Daily Challenges
        const dailyChallenges = [
            "Identify your triggers and create an avoidance plan",
            "Practice 10 minutes of mindfulness meditation",
            "Replace bad habit with 30 minutes of exercise",
            "Write down your reasons for quitting in a journal",
            "Tell a friend or family member about your commitment",
            "Create a list of healthy alternative activities",
            "Avoid situations that trigger your addiction today",
            "Practice deep breathing when you feel cravings",
            "Reward yourself with something healthy for your progress",
            "Reflect on your progress and adjust your plan if needed"
        ];

        // DOM Elements
        const setupScreen = document.getElementById('setupScreen');
        const welcomeScreen = document.getElementById('welcomeScreen');
        const appScreen = document.getElementById('appScreen');
        const statsScreen = document.getElementById('statsScreen');
        const celebration = document.getElementById('celebration');
        const resetModal = document.getElementById('resetModal');
        const continueModal = document.getElementById('continueModal');

        // Buttons
        const saveSetupBtn = document.getElementById('saveSetup');
        const startChallengeBtn = document.getElementById('startChallenge');
        const viewStatsBtn = document.getElementById('viewStats');
        const viewCalendarBtn = document.getElementById('viewCalendar');
        const resetChallengeBtn = document.getElementById('resetChallenge');
        const completeChallengeBtn = document.getElementById('completeChallenge');
        const markMissedDayBtn = document.getElementById('markMissedDay');
        const backToWelcomeBtn = document.getElementById('backToWelcome');
        const backFromStatsBtn = document.getElementById('backFromStats');
        const closeCelebrationBtn = document.getElementById('closeCelebration');
        const continueChallengeBtn = document.getElementById('continueChallenge');
        const newQuoteBtn = document.getElementById('newQuote');
        const confirmResetBtn = document.getElementById('confirmReset');
        const cancelResetBtn = document.getElementById('cancelReset');
        const confirmExtensionBtn = document.getElementById('confirmExtension');
        const cancelExtensionBtn = document.getElementById('cancelExtension');
        const prevMonthBtn = document.getElementById('prevMonth');
        const nextMonthBtn = document.getElementById('nextMonth');

        // Form Elements
        const userNameInput = document.getElementById('userName');
        const addictionTypeInput = document.getElementById('addictionType');
        const challengeDurationInput = document.getElementById('challengeDuration');
        const promiseInput = document.getElementById('promiseInput');
        const extendDurationInput = document.getElementById('extendDuration');

        // Calendar Variables
        let currentCalendarMonth = 0;
        let currentCalendarYear = 0;

        // Initialize the app
        function initApp() {
            // Load saved data from localStorage
            const savedData = localStorage.getItem('addictionChallengeData');
            if (savedData) {
                const parsedData = JSON.parse(savedData);
                Object.assign(appData, parsedData);
                
                // Check if setup is complete
                if (appData.userName && appData.startDate) {
                    // Check if start date is today or in the past
                    const today = new Date();
                    const startDate = new Date(appData.startDate);
                    
                    if (today < startDate) {
                        // If start date is in future, reset to today
                        appData.startDate = today.toISOString().split('T')[0];
                        saveData();
                    }
                    
                    showWelcomeScreen();
                } else {
                    showSetupScreen();
                }
                
                // Check if it's a new day
                checkNewDay();
                
                // Update UI with current data
                updateUI();
            } else {
                showSetupScreen();
            }
        }

        // Show setup screen
        function showSetupScreen() {
            setupScreen.style.display = 'flex';
            welcomeScreen.style.display = 'none';
            appScreen.style.display = 'none';
            statsScreen.style.display = 'none';
        }

        // Show welcome screen
        function showWelcomeScreen() {
            setupScreen.style.display = 'none';
            welcomeScreen.style.display = 'flex';
            appScreen.style.display = 'none';
            statsScreen.style.display = 'none';
            
            // Update personalized title
            document.getElementById('personalizedTitle').textContent = `${appData.userName}'s ${appData.challengeDuration} Days Challenge`;
            
            // Update challenge dates
            updateChallengeDates();
            
            // Check if challenge is completed
            if (appData.challengeCompleted) {
                startChallengeBtn.style.display = 'none';
                document.querySelector('.welcome-subtitle').textContent = 'Congratulations! You have completed your challenge!';
            } else {
                startChallengeBtn.style.display = 'inline-flex';
                document.querySelector('.welcome-subtitle').textContent = 'Transform Your Life • Build Better Habits • Win Your Freedom';
            }
        }

        // Show app screen
        function showAppScreen() {
            setupScreen.style.display = 'none';
            welcomeScreen.style.display = 'none';
            appScreen.style.display = 'block';
            statsScreen.style.display = 'none';
            
            // Update app title
            document.getElementById('appTitle').textContent = `${appData.userName}'s Challenge`;
        }

        // Show stats screen
        function showStatsScreen() {
            setupScreen.style.display = 'none';
            welcomeScreen.style.display = 'none';
            appScreen.style.display = 'none';
            statsScreen.style.display = 'block';
            
            updateStats();
        }

        // Save setup data
        function saveSetup() {
            if (!userNameInput.value.trim()) {
                alert('Please enter your name');
                return;
            }
            
            appData.userName = userNameInput.value.trim();
            appData.addictionType = addictionTypeInput.value;
            appData.challengeDuration = parseInt(challengeDurationInput.value);
            
            // Set start date to today
            const today = new Date();
            appData.startDate = today.toISOString().split('T')[0];
            
            // Generate challenge dates
            generateChallengeDates();
            
            // Save data
            saveData();
            
            // Show welcome screen
            showWelcomeScreen();
        }

        // Generate challenge dates
        function generateChallengeDates() {
            appData.challengeDates = [];
            const startDate = new Date(appData.startDate);
            
            for (let i = 0; i < appData.challengeDuration; i++) {
                const currentDate = new Date(startDate);
                currentDate.setDate(startDate.getDate() + i);
                appData.challengeDates.push(currentDate.toISOString().split('T')[0]);
            }
        }

        // Update challenge dates display
        function updateChallengeDates() {
            if (appData.challengeDates.length === 0) return;
            
            const startDate = new Date(appData.challengeDates[0]);
            const endDate = new Date(appData.challengeDates[appData.challengeDates.length - 1]);
            
            const options = { year: 'numeric', month: 'long', day: 'numeric' };
            const startDateStr = startDate.toLocaleDateString('en-US', options);
            const endDateStr = endDate.toLocaleDateString('en-US', options);
            
            document.getElementById('todayDate').textContent = `Today's Date: ${new Date().toLocaleDateString('en-US', options)}`;
            
            // Calculate next available date (tomorrow after 5 AM)
            const tomorrow = new Date();
            tomorrow.setDate(tomorrow.getDate() + 1);
            tomorrow.setHours(5, 0, 0, 0);
            
            document.getElementById('nextAvailableDate').textContent = `Next Challenge Available: ${tomorrow.toLocaleDateString('en-US', options)} after 5 AM`;
        }

        // Check if it's a new day (after 5 AM)
        function checkNewDay() {
            const now = new Date();
            const today = now.toISOString().split('T')[0];
            const currentHour = now.getHours();
            
            // Consider new day after 5 AM
            if (currentHour >= 5) {
                if (appData.lastLogin !== today) {
                    appData.lastLogin = today;
                    
                    // Update current day based on date
                    updateCurrentDayByDate();
                    
                    // Check if user maintained streak
                    if (appData.lastLogin) {
                        const lastDate = new Date(appData.lastLogin);
                        const currentDate = new Date(today);
                        const diffTime = Math.abs(currentDate - lastDate);
                        const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));
                        
                        if (diffDays === 1) {
                            appData.streak++;
                        } else if (diffDays > 1) {
                            appData.streak = 0;
                        }
                    } else {
                        appData.streak = 0;
                    }
                    
                    saveData();
                }
            }
        }

        // Update current day based on date
        function updateCurrentDayByDate() {
            const today = new Date().toISOString().split('T')[0];
            const startDate = new Date(appData.startDate);
            const currentDate = new Date(today);
            
            // If today is before start date, set to day 1
            if (currentDate < startDate) {
                appData.currentDay = 1;
                return;
            }
            
            // Calculate days difference
            const diffTime = currentDate - startDate;
            const diffDays = Math.floor(diffTime / (1000 * 60 * 60 * 24)) + 1;
            
            // If beyond challenge duration, set to last day
            appData.currentDay = Math.min(diffDays, appData.challengeDuration);
            appData.currentLevel = Math.floor((appData.currentDay - 1) / 10) + 1;
            
            // Check if challenge is completed
            if (appData.currentDay >= appData.challengeDuration && 
                appData.completedDays.length >= appData.challengeDuration * 0.8) { // At least 80% completed
                appData.challengeCompleted = true;
            }
        }

        // Check if current day's challenge is available (after 5 AM of the challenge date)
        function isChallengeAvailable(day) {
            if (day > appData.currentDay) return false;
            
            const now = new Date();
            const currentHour = now.getHours();
            const challengeDate = new Date(appData.challengeDates[day - 1]);
            const today = new Date();
            
            // If challenge date is today, check if it's after 5 AM
            if (challengeDate.toDateString() === today.toDateString()) {
                return currentHour >= 5;
            }
            
            // If challenge date is in the past, it's available
            return challengeDate < today;
        }

        // Update UI with current data
        function updateUI() {
            // Update welcome screen
            document.getElementById('currentLevel').textContent = appData.currentLevel;
            document.getElementById('currentDay').textContent = appData.currentDay;
            document.getElementById('totalDays').textContent = appData.challengeDuration;
            
            // Update app screen
            document.getElementById('displayLevel').textContent = appData.currentLevel;
            document.getElementById('progressDay').textContent = appData.currentDay;
            document.getElementById('totalDaysProgress').textContent = appData.challengeDuration;
            document.getElementById('challengeDay').textContent = appData.currentDay;
            document.getElementById('streakCount').textContent = `${appData.streak} Days`;
            document.getElementById('userAvatar').textContent = appData.userName.charAt(0).toUpperCase();
            
            // Update progress
            const progressPercent = (appData.currentDay / appData.challengeDuration) * 100;
            document.getElementById('progressFill').style.width = `${progressPercent}%`;
            document.getElementById('progressPercent').textContent = Math.round(progressPercent);
            
            // Update challenge
            const challengeIndex = (appData.currentDay - 1) % dailyChallenges.length;
            document.getElementById('challengeTitle').textContent = dailyChallenges[challengeIndex];
            document.getElementById('challengeDescription').textContent = getChallengeDescription(appData.currentDay);
            
            // Update challenge date
            if (appData.challengeDates.length >= appData.currentDay) {
                const challengeDate = new Date(appData.challengeDates[appData.currentDay - 1]);
                const options = { year: 'numeric', month: 'long', day: 'numeric' };
                document.getElementById('challengeDateDisplay').textContent = `Date: ${challengeDate.toLocaleDateString('en-US', options)}`;
            }
            
            // Update motivational quote
            updateMotivationalQuote();
            
            // Update stats screen
            updateStats();
            
            // Update calendar
            generateMonthlyCalendar();
            
            // Check if today's challenge is already completed or available
            const today = new Date().toISOString().split('T')[0];
            const isAvailable = isChallengeAvailable(appData.currentDay);
            
            if (appData.completedDays.includes(appData.currentDay)) {
                completeChallengeBtn.disabled = true;
                completeChallengeBtn.innerHTML = '<i class="fas fa-check-circle"></i> Today\'s Challenge Already Completed';
                completeChallengeBtn.className = 'btn btn-disabled';
            } else if (!isAvailable) {
                completeChallengeBtn.disabled = true;
                completeChallengeBtn.innerHTML = '<i class="fas fa-clock"></i> Challenge Not Available Yet';
                completeChallengeBtn.className = 'btn btn-disabled';
            } else {
                completeChallengeBtn.disabled = false;
                completeChallengeBtn.innerHTML = '<i class="fas fa-check-circle"></i> Complete Today\'s Challenge';
                completeChallengeBtn.className = 'btn btn-primary';
            }
            
            // Update mark missed button
            if (appData.missedDays.includes(appData.currentDay) || !isAvailable || appData.completedDays.includes(appData.currentDay)) {
                markMissedDayBtn.disabled = true;
                markMissedDayBtn.className = 'btn btn-disabled';
            } else {
                markMissedDayBtn.disabled = false;
                markMissedDayBtn.className = 'btn btn-secondary';
            }
            
            // Check if challenge is completed
            if (appData.challengeCompleted) {
                completeChallengeBtn.disabled = true;
                completeChallengeBtn.innerHTML = '<i class="fas fa-trophy"></i> Challenge Completed!';
                completeChallengeBtn.className = 'btn btn-success';
                markMissedDayBtn.style.display = 'none';
                
                // Show celebration if not already shown
                if (!localStorage.getItem('challengeCompletionShown')) {
                    showCompletionCelebration();
                    localStorage.setItem('challengeCompletionShown', 'true');
                }
            }
        }

        // Get challenge description based on day
        function getChallengeDescription(day) {
            const descriptions = [
                "Today, take some time to identify the situations, emotions, or people that trigger your addictive behavior. Write them down and create a plan to avoid or manage these triggers.",
                "Find a quiet space, sit comfortably, and focus on your breath. When your mind wanders, gently bring it back to your breathing. This practice will help you build mindfulness and self-control.",
                "Physical activity releases endorphins that can help reduce cravings. Go for a walk, run, or do any form of exercise you enjoy whenever you feel the urge to engage in your addictive behavior.",
                "Writing helps clarify your thoughts and strengthens your commitment. List all the reasons why you want to overcome this addiction and how your life will improve without it.",
                "Sharing your goal creates accountability. Choose someone supportive who can encourage you when things get tough and celebrate your successes with you.",
                "Create a list of activities you can do instead of giving in to cravings. This could include reading, hobbies, calling a friend, or anything else that brings you joy without the negative consequences.",
                "Be proactive today by avoiding people, places, or situations that typically lead to your addictive behavior. Plan your day carefully to minimize exposure to triggers.",
                "When cravings hit, take a moment to close your eyes and take 10 deep, slow breaths. Focus on the sensation of breathing to ride out the urge without giving in.",
                "Positive reinforcement helps build new habits. Treat yourself to something you enjoy that doesn't conflict with your recovery goals.",
                "Look back at your progress. What's working? What's challenging? Adjust your strategies based on what you've learned to set yourself up for continued success."
            ];
            
            return descriptions[(day - 1) % descriptions.length];
        }

        // Update motivational quote
        function updateMotivationalQuote() {
            const randomIndex = Math.floor(Math.random() * motivationalQuotes.length);
            document.getElementById('motivationalQuote').textContent = motivationalQuotes[randomIndex];
            document.getElementById('dailyMotivation').textContent = motivationalQuotes[randomIndex];
        }

        // Update stats screen
        function updateStats() {
            document.getElementById('statDaysCompleted').textContent = appData.completedDays.length;
            document.getElementById('statStreak').textContent = appData.streak;
            document.getElementById('statLevel').textContent = appData.currentLevel;
            document.getElementById('statDaysLeft').textContent = appData.challengeDuration - appData.currentDay + 1;
            document.getElementById('statTotalDays').textContent = appData.challengeDuration;
            
            const progressPercent = (appData.currentDay / appData.challengeDuration) * 100;
            document.getElementById('statProgressFill').style.width = `${progressPercent}%`;
            document.getElementById('statProgressPercent').textContent = Math.round(progressPercent);
            
            // Update challenge date range
            if (appData.challengeDates.length > 0) {
                const startDate = new Date(appData.challengeDates[0]);
                const endDate = new Date(appData.challengeDates[appData.challengeDates.length - 1]);
                const today = new Date();
                
                const options = { year: 'numeric', month: 'long', day: 'numeric' };
                const startDateStr = startDate.toLocaleDateString('en-US', options);
                const endDateStr = endDate.toLocaleDateString('en-US', options);
                
                document.getElementById('challengeDateRange').textContent = `Challenge Period: ${startDateStr} - ${endDateStr}`;
                
                // Update today's status
                if (today < startDate) {
                    document.getElementById('todayStatus').textContent = 'Challenge has not started yet';
                } else if (today > endDate) {
                    document.getElementById('todayStatus').textContent = 'Challenge has ended';
                } else {
                    const dayNumber = Math.floor((today - startDate) / (1000 * 60 * 60 * 24)) + 1;
                    const status = appData.completedDays.includes(dayNumber) ? 'Completed' : 
                                  appData.missedDays.includes(dayNumber) ? 'Missed' : 'Incomplete';
                    document.getElementById('todayStatus').textContent = `Today's Day: ${dayNumber}, Status: ${status}`;
                }
                
                // Update next challenge info
                const tomorrow = new Date();
                tomorrow.setDate(tomorrow.getDate() + 1);
                tomorrow.setHours(5, 0, 0, 0);
                
                if (appData.currentDay < appData.challengeDuration) {
                    document.getElementById('nextChallengeInfo').textContent = `Next Challenge Available: ${tomorrow.toLocaleDateString('en-US', options)} after 5 AM`;
                } else {
                    document.getElementById('nextChallengeInfo').textContent = 'You have completed all days! Congratulations!';
                }
            }
        }

        // Generate monthly calendar
        function generateMonthlyCalendar() {
            // Initialize calendar date if not set
            if (currentCalendarMonth === 0 || currentCalendarYear === 0) {
                const today = new Date();
                currentCalendarMonth = today.getMonth();
                currentCalendarYear = today.getFullYear();
            }
            
            const calendarGrid = document.getElementById('calendarGrid');
            calendarGrid.innerHTML = '';
            
            // Update calendar title
            const monthNames = ["January", "February", "March", "April", "May", "June",
                "July", "August", "September", "October", "November", "December"];
            document.getElementById('calendarMonthTitle').textContent = `${monthNames[currentCalendarMonth]} ${currentCalendarYear}`;
            
            // Get first day of month and number of days in month
            const firstDay = new Date(currentCalendarYear, currentCalendarMonth, 1);
            const lastDay = new Date(currentCalendarYear, currentCalendarMonth + 1, 0);
            const daysInMonth = lastDay.getDate();
            const startingDay = firstDay.getDay(); // 0 = Sunday, 1 = Monday, etc.
            
            // Add empty cells for days before the first day of the month
            for (let i = 0; i < startingDay; i++) {
                const dayElement = document.createElement('div');
                dayElement.className = 'calendar-day other-month';
                calendarGrid.appendChild(dayElement);
            }
            
            // Add cells for each day of the month
            for (let day = 1; day <= daysInMonth; day++) {
                const dayElement = document.createElement('div');
                dayElement.className = 'calendar-day';
                
                // Create date for this day
                const currentDate = new Date(currentCalendarYear, currentCalendarMonth, day);
                const dateString = currentDate.toISOString().split('T')[0];
                
                // Check if this date is in the challenge period
                const challengeDayIndex = appData.challengeDates.indexOf(dateString);
                
                if (challengeDayIndex !== -1) {
                    const challengeDay = challengeDayIndex + 1;
                    
                    // Check day status
                    if (appData.completedDays.includes(challengeDay)) {
                        dayElement.classList.add('completed');
                    } else if (appData.missedDays.includes(challengeDay)) {
                        dayElement.classList.add('missed');
                    } else if (challengeDay === appData.currentDay) {
                        dayElement.classList.add('current');
                    } else if (challengeDay > appData.currentDay) {
                        dayElement.classList.add('future');
                    }
                    
                    // Add day number
                    const dayNumber = document.createElement('div');
                    dayNumber.className = 'day-number';
                    dayNumber.textContent = day;
                    dayElement.appendChild(dayNumber);
                    
                    // Add day status
                    const dayStatus = document.createElement('div');
                    dayStatus.className = 'day-status';
                    
                    if (appData.completedDays.includes(challengeDay)) {
                        dayStatus.textContent = 'Complete';
                        dayStatus.style.color = '#00c851';
                    } else if (appData.missedDays.includes(challengeDay)) {
                        dayStatus.textContent = 'Missed';
                        dayStatus.style.color = '#ff3547';
                    } else if (challengeDay === appData.currentDay) {
                        dayStatus.textContent = 'Today';
                        dayStatus.style.color = '#6a11cb';
                    } else if (challengeDay > appData.currentDay) {
                        dayStatus.textContent = 'Upcoming';
                        dayStatus.style.color = '#6c757d';
                    } else {
                        dayStatus.textContent = 'Incomplete';
                        dayStatus.style.color = '#ffbb33';
                    }
                    
                    dayElement.appendChild(dayStatus);
                } else {
                    // This day is not in the challenge period
                    dayElement.classList.add('other-month');
                    
                    // Add day number
                    const dayNumber = document.createElement('div');
                    dayNumber.className = 'day-number';
                    dayNumber.textContent = day;
                    dayElement.appendChild(dayNumber);
                }
                
                calendarGrid.appendChild(dayElement);
            }
        }

        // Navigate to previous month
        function prevMonth() {
            currentCalendarMonth--;
            if (currentCalendarMonth < 0) {
                currentCalendarMonth = 11;
                currentCalendarYear--;
            }
            generateMonthlyCalendar();
        }

        // Navigate to next month
        function nextMonth() {
            currentCalendarMonth++;
            if (currentCalendarMonth > 11) {
                currentCalendarMonth = 0;
                currentCalendarYear++;
            }
            generateMonthlyCalendar();
        }

        // Complete challenge
        function completeChallenge() {
            // Check if challenge is available
            if (!isChallengeAvailable(appData.currentDay)) {
                alert('This challenge is not available yet! Please try after 5 AM.');
                return;
            }
            
            // Check if already completed
            if (appData.completedDays.includes(appData.currentDay)) {
                alert('You have already completed today\'s challenge!');
                return;
            }
            
            // Add to completed days
            if (!appData.completedDays.includes(appData.currentDay)) {
                appData.completedDays.push(appData.currentDay);
                
                // Remove from missed days if it was there
                const missedIndex = appData.missedDays.indexOf(appData.currentDay);
                if (missedIndex > -1) {
                    appData.missedDays.splice(missedIndex, 1);
                }
                
                // Update streak
                appData.streak++;
                
                saveData();
                updateUI();
            }
            
            // Check if challenge is completed
            if (appData.currentDay >= appData.challengeDuration && 
                appData.completedDays.length >= appData.challengeDuration * 0.8) {
                appData.challengeCompleted = true;
                saveData();
                showCompletionCelebration();
            } else {
                // Show regular celebration
                showCelebration();
            }
        }

        // Mark missed day
        function markMissedDay() {
            // Check if challenge is available
            if (!isChallengeAvailable(appData.currentDay)) {
                alert('This challenge is not available yet!');
                return;
            }
            
            // Check if already completed
            if (appData.completedDays.includes(appData.currentDay)) {
                alert('You have already completed today\'s challenge!');
                return;
            }
            
            // Check if already marked as missed
            if (appData.missedDays.includes(appData.currentDay)) {
                alert('You have already marked today as missed!');
                return;
            }
            
            // Add to missed days
            appData.missedDays.push(appData.currentDay);
            
            // Reset streak
            appData.streak = 0;
            
            saveData();
            updateUI();
            
            alert('Day marked as missed. Don\'t worry, try again tomorrow!');
        }

        // Show regular celebration animation
        function showCelebration() {
            const message = appData.currentDay % 10 === 0 ? 
                `Congratulations! You've completed Level ${appData.currentLevel - 1} and unlocked Level ${appData.currentLevel}!` :
                `Awesome! You've successfully completed Day ${appData.currentDay}! Keep up the great work on your journey to freedom.`;
            
            document.getElementById('celebrationMessage').textContent = message;
            celebration.style.display = 'flex';
            
            // Create confetti
            createConfetti();
        }

        // Show completion celebration
        function showCompletionCelebration() {
            const message = `Congratulations! You've successfully completed your ${appData.challengeDuration}-day challenge! You are now free from your addiction.`;
            
            document.getElementById('celebrationMessage').textContent = message;
            celebration.style.display = 'flex';
            
            // Create confetti
            createConfetti();
        }

        // Show continue challenge modal
        function showContinueModal() {
            continueModal.style.display = 'flex';
        }

        // Extend challenge
        function extendChallenge() {
            const extendDays = parseInt(extendDurationInput.value);
            appData.challengeDuration += extendDays;
            
            // Generate additional challenge dates
            const lastDate = new Date(appData.challengeDates[appData.challengeDates.length - 1]);
            for (let i = 1; i <= extendDays; i++) {
                const newDate = new Date(lastDate);
                newDate.setDate(lastDate.getDate() + i);
                appData.challengeDates.push(newDate.toISOString().split('T')[0]);
            }
            
            // Reset completion status
            appData.challengeCompleted = false;
            localStorage.removeItem('challengeCompletionShown');
            
            saveData();
            updateUI();
            
            continueModal.style.display = 'none';
            celebration.style.display = 'none';
            showWelcomeScreen();
            
            alert(`Challenge extended by ${extendDays} days! Continue your journey to freedom!`);
        }

        // Reset challenge
        function resetChallenge() {
            resetModal.style.display = 'flex';
        }

        // Confirm reset challenge
        function confirmReset() {
            const promiseText = "I promise to myself that I will complete this challenge no matter what obstacles come my way. I am stronger than my addiction and I will not give up on myself. I commit to taking one day at a time and celebrating each small victory.";
            
            if (promiseInput.value.trim() !== promiseText) {
                alert('Please type the promise exactly as shown to confirm your commitment.');
                return;
            }
            
            // Reset challenge data
            appData.startDate = new Date().toISOString().split('T')[0];
            appData.currentDay = 1;
            appData.currentLevel = 1;
            appData.streak = 0;
            appData.completedDays = [];
            appData.missedDays = [];
            appData.challengeCompleted = false;
            
            // Generate new challenge dates
            generateChallengeDates();
            
            // Save data
            saveData();
            
            // Update UI
            updateUI();
            
            // Close modal and show welcome screen
            resetModal.style.display = 'none';
            showWelcomeScreen();
            
            alert('Challenge reset successfully! A fresh start for your journey to freedom.');
        }

        // Create confetti animation
        function createConfetti() {
            const colors = ['#ff4d94', '#6a11cb', '#2575fc', '#00c851', '#ffbb33'];
            
            for (let i = 0; i < 100; i++) {
                const confetti = document.createElement('div');
                confetti.className = 'confetti';
                confetti.style.left = Math.random() * 100 + 'vw';
                confetti.style.background = colors[Math.floor(Math.random() * colors.length)];
                confetti.style.animationDelay = Math.random() * 5 + 's';
                document.body.appendChild(confetti);
                
                // Remove confetti after animation
                setTimeout(() => {
                    confetti.remove();
                }, 5000);
            }
        }

        // Save data to localStorage
        function saveData() {
            localStorage.setItem('addictionChallengeData', JSON.stringify(appData));
        }

        // Event Listeners
        saveSetupBtn.addEventListener('click', saveSetup);
        
        startChallengeBtn.addEventListener('click', () => {
            showAppScreen();
        });

        viewStatsBtn.addEventListener('click', () => {
            showStatsScreen();
        });

        viewCalendarBtn.addEventListener('click', () => {
            showAppScreen();
            // Scroll to calendar
            document.getElementById('calendarView').scrollIntoView({ behavior: 'smooth' });
        });

        resetChallengeBtn.addEventListener('click', resetChallenge);

        completeChallengeBtn.addEventListener('click', completeChallenge);

        markMissedDayBtn.addEventListener('click', markMissedDay);

        backToWelcomeBtn.addEventListener('click', () => {
            showWelcomeScreen();
        });

        backFromStatsBtn.addEventListener('click', () => {
            showAppScreen();
        });

        closeCelebrationBtn.addEventListener('click', () => {
            celebration.style.display = 'none';
            showWelcomeScreen();
        });

        continueChallengeBtn.addEventListener('click', showContinueModal);

        newQuoteBtn.addEventListener('click', updateMotivationalQuote);

        confirmResetBtn.addEventListener('click', confirmReset);

        cancelResetBtn.addEventListener('click', () => {
            resetModal.style.display = 'none';
            promiseInput.value = '';
        });

        confirmExtensionBtn.addEventListener('click', extendChallenge);

        cancelExtensionBtn.addEventListener('click', () => {
            continueModal.style.display = 'none';
            celebration.style.display = 'none';
            showWelcomeScreen();
        });

        prevMonthBtn.addEventListener('click', prevMonth);

        nextMonthBtn.addEventListener('click', nextMonth);

        // Initialize the app
        initApp();
    </script>
</body>
</html>